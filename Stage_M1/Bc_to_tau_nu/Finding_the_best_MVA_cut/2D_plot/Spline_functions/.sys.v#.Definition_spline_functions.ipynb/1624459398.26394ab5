{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "maritime-sandwich",
   "metadata": {},
   "source": [
    "# Nouvelle Méthode pour calculer l'efficacité d'un cut"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "thrown-block",
   "metadata": {},
   "source": [
    "Comme on a pu le voir précedemment, pour des hautes valeurs de cut, il n'y a plus aucun évènement de background et on obtient une efficacité égale à 1. Pour résoudre ce problème, nous allons remplacer dans les programmes utilisés la valeur de la longueur du data frame après cut, par la valeur de l'intégrale de la courbe formé par l'histogramme pour la varaible de cut considérée."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "former-millennium",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/cvmfs/sft.cern.ch/lcg/releases/Python/3.8.6-3199b/x86_64-centos7-gcc8-opt/lib/python3.8/_collections_abc.py:832: MatplotlibDeprecationWarning: Support for setting the 'text.latex.preamble' or 'pgf.preamble' rcParam to a list of strings is deprecated since 3.3 and will be removed two minor releases later; set it to a single string instead.\n",
      "  self[key] = other[key]\n"
     ]
    }
   ],
   "source": [
    "import pandas\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "import scipy.interpolate as interpolate\n",
    "import pickle\n",
    "\n",
    "from matplotlib import rc\n",
    "rc('font',**{'family':'serif','serif':['Roman']})\n",
    "rc('text', usetex=True)\n",
    "params= {'text.latex.preamble' : [r'\\usepackage{amsmath}']}\n",
    "plt.rcParams.update(params)\n",
    "plt.rcParams['text.latex.preamble'] = r\"\\usepackage{bm} \\usepackage{amsmath}\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "packed-network",
   "metadata": {},
   "outputs": [],
   "source": [
    "bc_tree = uproot.open('/eos/experiment/fcc/ee/analyses/case-studies/flavour/Bc2TauNu/flatNtuples/spring2021/prod_04/Analysis_stage2/p8_ee_Zbb_ecm91_EvtGen_Bc2TauNuTAUHADNU.root')['events']\n",
    "bu_tree = uproot.open('/eos/experiment/fcc/ee/analyses/case-studies/flavour/Bc2TauNu/flatNtuples/spring2021/prod_04/Analysis_stage2/p8_ee_Zbb_ecm91_EvtGen_Bu2TauNuTAUHADNU.root')['events']\n",
    "\n",
    "bb_tree = uproot.open('/eos/experiment/fcc/ee/analyses/case-studies/flavour/Bc2TauNu/flatNtuples/spring2021/prod_04/Analysis_stage2/p8_ee_Zbb_ecm91_EvtGen.root')['events']\n",
    "cc_tree = uproot.open('/eos/experiment/fcc/ee/analyses/case-studies/flavour/Bc2TauNu/flatNtuples/spring2021/prod_04/Analysis_stage2/p8_ee_Zcc_ecm91.root')['events']\n",
    "uds_tree = uproot.open('/eos/experiment/fcc/ee/analyses/case-studies/flavour/Bc2TauNu/flatNtuples/spring2021/prod_04/Analysis_stage2/p8_ee_Zuds_ecm91.root')['events']\n",
    "\n",
    "tree_gen = uproot.open(\"/eos/experiment/fcc/ee/analyses/case-studies/flavour/Bc2TauNu/flatNtuples/spring2021/prod_04/Analysis_stage2/p8_ee_Zbb_ecm91_EvtGen_Bc2TauNuTAUHADNU.root\")[\"metadata\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "afraid-liability",
   "metadata": {},
   "outputs": [],
   "source": [
    "bc_df = bc_tree.arrays(library=\"pd\", how=\"zip\", filter_name=[\"EVT_*\"])\n",
    "\n",
    "bu_df = bu_tree.arrays(library=\"pd\", how=\"zip\", filter_name=[\"EVT_*\"])\n",
    "bb_df = bb_tree.arrays(library=\"pd\", how=\"zip\", filter_name=[\"EVT_*\"])\n",
    "cc_df = cc_tree.arrays(library=\"pd\", how=\"zip\", filter_name=[\"EVT_*\"])\n",
    "uds_df = uds_tree.arrays(library=\"pd\", how=\"zip\", filter_name=[\"EVT_*\"])\n",
    "\n",
    "df_gen = tree_gen.arrays(library=\"pd\", how=\"zip\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "burning-logan",
   "metadata": {},
   "source": [
    "#### Définition nouveaux dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "impressed-practitioner",
   "metadata": {},
   "outputs": [],
   "source": [
    "cut = 0.95\n",
    "\n",
    "bc_df_1 = bc_df[bc_df['EVT_MVA1']>cut]\n",
    "bu_df_1 = bu_df[bu_df['EVT_MVA1']>cut]\n",
    "bb_df_1 = bb_df[bb_df['EVT_MVA1']>cut]\n",
    "cc_df_1 = cc_df[cc_df['EVT_MVA1']>cut]\n",
    "uds_df_1 = uds_df[uds_df['EVT_MVA1']>cut]\n",
    "\n",
    "bc_df_2 = bc_df[bc_df['EVT_MVA2']>cut]\n",
    "bu_df_2 = bu_df[bu_df['EVT_MVA2']>cut]\n",
    "bb_df_2 = bb_df[bb_df['EVT_MVA2']>cut]\n",
    "cc_df_2 = cc_df[cc_df['EVT_MVA2']>cut]\n",
    "uds_df_2 = uds_df[uds_df['EVT_MVA2']>cut]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "attended-gateway",
   "metadata": {},
   "source": [
    "## Histogrammes des valeurs en log(1-MVA)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "sitting-playlist",
   "metadata": {},
   "outputs": [],
   "source": [
    "s_bin = 3\n",
    "f_bin = 10\n",
    "nb_bins = 50\n",
    "title = r'$Z \\rightarrow b\\bar{b}$'\n",
    "\n",
    "plt.figure()\n",
    "plt.hist(-np.log(1-bb_df_1['EVT_MVA1']), bins=nb_bins, range=(s_bin, f_bin), color= '#3182bd', histtype='step', label=title, density=True)\n",
    "plt.xlim(3,10)\n",
    "plt.yscale('log')\n",
    "plt.xlabel(\"-log(1-MVA1)\")\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA1$>$0.95\")\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "greater-short",
   "metadata": {},
   "outputs": [],
   "source": [
    "s_bin = 3\n",
    "f_bin = 10\n",
    "nb_bins = 50\n",
    "title = r'$Z \\rightarrow b\\bar{b}$'\n",
    "\n",
    "plt.figure()\n",
    "plt.hist(-np.log(1-bb_df_2['EVT_MVA2']), bins=nb_bins, range=(s_bin, f_bin), color= '#3182bd', histtype='step', label=title, density=True)\n",
    "plt.xlim(3,10)\n",
    "plt.yscale('log')\n",
    "plt.xlabel(\"-log(1-MVA2)\")\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA2$>$0.95\")\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "handed-objective",
   "metadata": {},
   "source": [
    "## Histogrammes des valeurs en log(1-MVA) + splines functions tracée"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "hungarian-wealth",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "s_bin = 3\n",
    "f_bin = 10\n",
    "nb_bins = 50\n",
    "label_hist = r'$Z \\rightarrow b\\bar{b}$'\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "MVA1 = plt.hist(-np.log(1-bb_df_2['EVT_MVA1']), bins=nb_bins, range=(s_bin, f_bin), density=True, histtype='step', label=label_hist, color= '#3182bd')\n",
    "x_MVA1_values = MVA1[1][:-1]\n",
    "MVA1_bins = MVA1[0]\n",
    "\n",
    "MVA1_spline = interpolate.splrep(x=x_MVA1_values, y=MVA1_bins)\n",
    "MVA1_spline_values = interpolate.splev(x_MVA1_values, MVA1_spline)\n",
    "\n",
    "plt.plot(x_MVA1_values, MVA1_spline_values, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(3,10)\n",
    "plt.yscale('log')\n",
    "plt.xlabel(\"-log(1-MVA1)\")\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA1$>$0.95\")\n",
    "\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "statutory-qualification",
   "metadata": {},
   "outputs": [],
   "source": [
    "s_bin = 3\n",
    "f_bin = 10\n",
    "nb_bins = 50\n",
    "label_hist = r'$Z \\rightarrow b\\bar{b}$'\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "MVA2 = plt.hist(-np.log(1-bb_df_2['EVT_MVA2']), bins=nb_bins, range=(s_bin, f_bin), density=True, histtype='step', label=label_hist, color= '#3182bd')\n",
    "x_MVA2_values = MVA2[1][:-1]\n",
    "MVA2_bins = MVA2[0]\n",
    "\n",
    "MVA2_spline = interpolate.splrep(x=x_MVA2_values, y=MVA2_bins)\n",
    "MVA2_spline_values = interpolate.splev(x_MVA2_values, MVA2_spline)\n",
    "\n",
    "plt.plot(x_MVA2_values, MVA2_spline_values, color='#de2d26', label=label_spline)\n",
    "\n",
    "\n",
    "plt.xlim(3,10)\n",
    "plt.yscale('log')\n",
    "plt.xlabel(\"-log(1-MVA2)\")\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA2$>$0.95\")\n",
    "plt.legend()\n",
    "\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dependent-gnome",
   "metadata": {},
   "source": [
    "## Histogrammes des valeurs en MVA + spline function + enregistrement de la spline function"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "rocky-tissue",
   "metadata": {},
   "outputs": [],
   "source": [
    "#MVA1\n",
    "cut_var = 'EVT_MVA1' #:)\n",
    "cut_min = 3\n",
    "cut_max = 9\n",
    "nb_bins = 50\n",
    "\n",
    "label_hist = r'$Z \\rightarrow b\\bar{b}$'\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "counts, bin_edges = np.histogram(-np.log(1-bb_df_1[cut_var]), bins=nb_bins, range=(cut_min, cut_max))\n",
    "\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2\n",
    "err = np.sqrt(counts) #erreur en racine(N)\n",
    "#print(counts)\n",
    "\n",
    "#Normalise\n",
    "#err = err / np.sum(counts)\n",
    "#counts = counts / np.sum(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', color='k', markersize=2, label=label_hist) \n",
    "\n",
    "#Cubic spline of the MVA distribution\n",
    "weights = 1./err\n",
    "spline = interpolate.splrep(bin_centres, counts, w=weights)\n",
    "\n",
    "cut_vals = np.linspace(cut_min, cut_max, 1000) #pour avoir une courbe continue\n",
    "spline_vals = interpolate.splev(cut_vals, spline)\n",
    "\n",
    "plt.plot(cut_vals, spline_vals, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(cut_min, cut_max)\n",
    "plt.yscale('log')\n",
    "plt.xlabel(\"-log(1-MVA1)\") #:)\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA1$>$0.95\") #:)\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "front-soundtrack",
   "metadata": {},
   "outputs": [],
   "source": [
    "#MVA2\n",
    "cut_var = 'EVT_MVA2'\n",
    "cut_min = 3\n",
    "cut_max = 8\n",
    "nb_bins = 35\n",
    "\n",
    "label_hist = r'$Z \\rightarrow b\\bar{b}$'\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "counts, bin_edges = np.histogram(-np.log(1-bb_df_2[cut_var]), bins=nb_bins, range=(cut_min, cut_max))\n",
    "\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2\n",
    "err = np.sqrt(counts) #erreur en racine(N)\n",
    "#print(counts)\n",
    "\n",
    "#Normalise\n",
    "#err = err / np.sum(counts)\n",
    "#counts = counts / np.sum(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', color='k', markersize=2, label=label_hist) \n",
    "\n",
    "#Cubic spline of the MVA distribution\n",
    "weights = 1./err\n",
    "spline = interpolate.splrep(bin_centres, counts, w=weights) \n",
    "\n",
    "cut_vals = np.linspace(cut_min, cut_max, 1000) #pour avoir une courbe continue\n",
    "spline_vals = interpolate.splev(cut_vals, spline)\n",
    "\n",
    "plt.plot(cut_vals, spline_vals, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(cut_min,cut_max)\n",
    "plt.yscale('log')\n",
    "plt.xlabel(\"-log(1-MVA2)\")\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA2$>$0.95\")\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "flush-methodology",
   "metadata": {},
   "source": [
    "### Définition des splines"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "duplicate-substitute",
   "metadata": {},
   "source": [
    "##### Définition de splines en log"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "banner-broadcasting",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Modélisation du nb d'élèments de bkg pour différentes valeurs de MVA1\n",
    "\n",
    "\n",
    "#Paramètres\n",
    "cut_var = 'EVT_MVA1' #:)\n",
    "\n",
    "cut_min = -np.log(1-0.95) #log\n",
    "cut_max = 9\n",
    "\n",
    "nb_bins = 50\n",
    "cut_vals = -np.log(1-bb_df_1[cut_var]) #:) #log\n",
    "\n",
    "\n",
    "\n",
    "#Programme\n",
    "label_hist = r'$Z \\rightarrow b\\bar{b}$'\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "counts, bin_edges = np.histogram(cut_vals, bins=nb_bins, range=(cut_min, cut_max))\n",
    "print(counts)\n",
    "\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2\n",
    "err = np.sqrt(counts) #erreur en racine(N)\n",
    "#print(err)\n",
    "\n",
    "#Normalise\n",
    "#err = err / np.sum(counts)\n",
    "#counts = counts / np.sum(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', color='k', markersize=2, label=label_hist) \n",
    "\n",
    "#Cubic spline of the MVA distribution\n",
    "weights = 1./err\n",
    "print(weights)\n",
    "spline = interpolate.splrep(bin_centres, counts, w=weights)\n",
    "\n",
    "cut_vals = np.linspace(cut_min, cut_max, 1000) #pour avoir une courbe continue\n",
    "spline_vals = interpolate.splev(cut_vals, spline)\n",
    "print(spline_vals.max())\n",
    "\n",
    "plt.plot(cut_vals, spline_vals, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(cut_min, cut_max)\n",
    "plt.xlabel(\"-log(1-MVA1)\") #:)\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA1$>$0.95\") #:)\n",
    "#plt.ylim(0,counts.max())\n",
    "plt.yscale('log')\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n",
    "#pickle.dump(spline, open('MVA1_spline_log.pkl','wb')) #:)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ready-abraham",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Modélisation du nb d'élèments de bkg pour différentes valeurs de MVA1\n",
    "cut_var = 'EVT_MVA2' #:)\n",
    "cut_min = -np.log(1-0.95) #log\n",
    "cut_max = 8 #cut_vals.max()\n",
    "nb_bins = 35\n",
    "\n",
    "cut_vals = -np.log(1-bb_df_2[cut_var]) #:) #log\n",
    "\n",
    "\n",
    "label_hist = r'$Z \\rightarrow b\\bar{b}$'\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "counts, bin_edges = np.histogram(cut_vals, bins=nb_bins, range=(cut_min, cut_max))\n",
    "print(bin_edges)\n",
    "print(counts)\n",
    "\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2\n",
    "err = np.sqrt(counts) #erreur en racine(N)\n",
    "\n",
    "#Normalise\n",
    "#err = err / np.sum(counts)\n",
    "#counts = counts / np.sum(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', color='k', markersize=2, label=label_hist) \n",
    "\n",
    "#Cubic spline of the MVA distribution\n",
    "weights = 1./err\n",
    "spline = interpolate.splrep(bin_centres, counts, w=weights)\n",
    "\n",
    "cut_vals = np.linspace(cut_min, cut_max, 1000) #pour avoir une courbe continue\n",
    "spline_vals = interpolate.splev(cut_vals, spline)\n",
    "\n",
    "plt.plot(cut_vals, spline_vals, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(cut_min, cut_max)\n",
    "plt.xlabel(\"-log(1-MVA2)\") #:)\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA2$>$0.95\") #:)\n",
    "plt.ylim(0,counts.max())\n",
    "plt.yscale('log')\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n",
    "#pickle.dump(spline, open('MVA2_spline_log.pkl','wb')) #:)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "figured-cloud",
   "metadata": {},
   "outputs": [],
   "source": [
    "print(spline_vals.min())"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "surprised-hybrid",
   "metadata": {},
   "source": [
    "##### Définitions de splines sans log"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "imported-albuquerque",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "prospective-intake",
   "metadata": {},
   "outputs": [],
   "source": [
    "#MVA1\n",
    "cut_var = 'EVT_MVA1' #:)\n",
    "cut_vals = bb_df_1[cut_var] #:) #log\n",
    "cut_min = 0.95 #log\n",
    "cut_max = cut_vals.max()\n",
    "nb_bins = 50\n",
    "print(cut_min)\n",
    "print(cut_max)\n",
    "\n",
    "label_hist = r'$Z \\rightarrow b\\bar{b}$'\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "counts, bin_edges = np.histogram(cut_vals, bins=nb_bins, range=(cut_min, cut_max))\n",
    "print(counts)\n",
    "\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2\n",
    "err = np.sqrt(counts) #erreur en racine(N)\n",
    "\n",
    "#Normalise\n",
    "#err = err / np.sum(counts)\n",
    "#counts = counts / np.sum(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', color='k', markersize=2, label=label_hist) \n",
    "\n",
    "#Cubic spline of the MVA distribution\n",
    "weights = 1./err\n",
    "spline = interpolate.splrep(bin_centres, counts, w=weights)\n",
    "\n",
    "cut_vals = np.linspace(cut_min, cut_max, 1000) #pour avoir une courbe continue\n",
    "spline_vals = interpolate.splev(cut_vals, spline)\n",
    "\n",
    "plt.plot(cut_vals, spline_vals, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(cut_min, cut_max)\n",
    "plt.xlabel(\"-log(1-MVA1)\") #:)\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA1$>$0.95\") #:)\n",
    "plt.ylim(0,counts.max())\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n",
    "#pickle.dump(spline, open('MVA1_spline.pkl','wb')) #:)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "deadly-ultimate",
   "metadata": {},
   "outputs": [],
   "source": [
    "#MVA2\n",
    "cut_var = 'EVT_MVA2' #:)\n",
    "cut_vals = bb_df_2[cut_var] #:)\n",
    "cut_min = 0.95\n",
    "cut_max = cut_vals.max()\n",
    "nb_bins = 50\n",
    "\n",
    "label_hist = r'$Z \\rightarrow b\\bar{b}$'\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "counts, bin_edges = np.histogram(cut_vals, bins=nb_bins, range=(cut_min, cut_max))\n",
    "\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2.\n",
    "err = np.sqrt(counts) #erreur en racine(N)\n",
    "#print(counts)\n",
    "\n",
    "#Normalise\n",
    "#err = err / np.sum(counts)\n",
    "#counts = counts / np.sum(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', color='k', markersize=2, label=label_hist) \n",
    "\n",
    "#Cubic spline of the MVA distribution\n",
    "weights = 1./err\n",
    "spline = interpolate.splrep(bin_centres, counts, w=weights) \n",
    "\n",
    "cut_vals = np.linspace(cut_min, cut_max, 1000) #pour avoir une courbe continue\n",
    "spline_vals = interpolate.splev(cut_vals, spline)\n",
    "\n",
    "plt.plot(cut_vals, spline_vals, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(cut_min,cut_max)\n",
    "plt.xlabel(\"MVA2\")\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA2$>$0.95\")\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n",
    "#pickle.dump(spline, open('MVA2_spline_log.pkl','wb'))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "virtual-value",
   "metadata": {},
   "source": [
    "## Z->cc"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "id": "registered-repeat",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[2281 2083 1777 1629 1519 1347 1264 1121  963  860  794  707  675  565\n",
      "  509  492  402  344  339  290  255  205  176  140  149  126   83   80\n",
      "   68   55   42   21   26   10   11]\n",
      "[0.0209381  0.02191066 0.02372227 0.02477647 0.0256579  0.02724684\n",
      " 0.0281272  0.02986738 0.03222455 0.03409972 0.03548867 0.03760887\n",
      " 0.03849002 0.04207032 0.04432422 0.04508348 0.04987547 0.05391639\n",
      " 0.05431254 0.05872202 0.06262243 0.06984303 0.07537784 0.08451543\n",
      " 0.08192319 0.08908708 0.10976426 0.1118034  0.12126781 0.13483997\n",
      " 0.15430335 0.21821789 0.19611614 0.31622777 0.30151134]\n",
      "2403.4277671064765\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYcAAAETCAYAAADd6corAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8QVMy6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAx7UlEQVR4nO3de3hU1b3/8ffKJCFcMplwlVuMWry0msYWe7Ux2NbT82uLoPXUegGilSgoSLXVnlooaE9ta0VQasUqmFbphTaBXk7rUQnR2tOWHmL0HEVUQsRwJ0O4k8v6/TF7hmGSSSZkJntm8nk9zzzMrFmz93eSsL97rbXX2sZai4iISLgMtwMQEZHko+QgIiIdKDmIiEgHSg4iItKBkoOIiHSQ6XYAkhqMMV6guJO3aq21zX0cTpeMMUXW2rpk3X+s8RljCoBCwB9ZP/z3Ya2tMcYUAb7g6/B9OeWh35MxpiS8jkhn1HKQWE0Biq21NWEHliXJmBiANTHW9SZo/+uj7aMn8VlrGwgkgM7qFzv7qXXq1gELCSSTSIVhiaEImBcl9hJjzHxjTEks8UV8dpoxZrIxZo6T1DqrMyesjjesfIWz3/nRPit9T8lBYlVvrV0KoTPap4BL+mLHxhivc+AKPoqi1XUOkvUxbnpKPOKL3L+1Nj/aPnoYHwQO/rXGmMlR9heenFcAkyKq+Ky1FeGvgdLOEmO01oQxZlpXATp/D5OstWuBKgJJKrJOCXBGWJ0lYW9XAtXASichShJQcpBY1ULoTPgp4PJTaTUYY+bHWK8keACz1jaHHbhqo3XJGGOKOjvzNMYUhG8vuH1goVNe0FXdTvZR4tQLPvcGnwfrdLWPzr5jNyqBqeEx0nmCqQJmRGzTF1HHF6wXw36Dqp2z+mhJYgqwBUKtnSmd1CkFmsLqlIa953dapEoMSUTJQWISlgiWACt60afv7+rM3znILnaSwZJoZZ18bj7gd14Whm+PQPdXDYEDdTDh1BBoDYUOStHqRqh36jQ4z+c5Pxufs41gq6rTfYTFNdl5/6loP4sg58x/Slg8hZ0dSJ04VuIcnJ1YasP2WeKcuVcCZd3tN2y7DdbaRZxIEpHdTr5uXkNYMnO+R2HYe4VhXVpR/zakbyk5SMyCB+CIborIOpFdQCc9CBysFnbWTRJslVhrg33i6zor6+Rz04B85yAWPGgDoW6eqWHVi6PFHktd5wBc6xx4izmRkAhLAv7Iz3WynbXOU193dR0rie1sP/zAXxwliawFfD3t3w9LEvR0bML5m7kwyoUNVU6ifIgoyV/6npKDxMQ5mF8YPEg73SrxHjycQtiZbvCMuZOySIU4XRaRnGS12Ekgvmh1Yq3rqORE18m6aOMBne2jF1YAZd1daeQc+Aud340/4u3CsCRdTQLGXLriJN5iAr/Pegi11gqd95s5ubtJXKTkIN0Ku8JlelhxabSujeAVTZ09CBwcFoSdOUfaErbfgi7KwlUD+Z2Ug3O27SSVLWHfJ1xxD+oGD8DBFkYVgTN1f5T9R+7jlIR148WynSoCZ+C1wQInqVSE/R4W04OuJWcbBcExI2vtorAkVYXz83eSYFXYZ4LjL96wrrRiAsku+H18YZ+t70lMkjhKDtIl5z/sGgJny8XOmeeKbj7WFV8X4xVVQH7Y2W20spM4B5yNYXV8YWfz1c7r4GdLwz66ImKQtau6kWqdA20zgXGFOgglL19YUjlpH065L2yQ2hfteznvLwx7f4UTY7Alh+m81bKYQPffSZevdpJYi03g0tJgy6kEuJDA1UyhpBiWFEojkgJwInE525ni7D9ovTkx16LQqTOVQBcShCUSAsn58s5+FtL3jJbsFkk/xpiCeF39Y4yZ1tU4U1i9EgKJstP9OsmpsLNuseB4VLLNm+nPlBxERKQDdSuJiEgHSg4iItJBQhbeCw4KwonruZ1BzC0EBsqCyzAEB9PCB/Q6lImISN+Ke8sheI24kxTKwq6Q2AhUhyWGovB60cpERKTvJaLlUM+Ja7H9BCa4nDRr1VHKieuwm5zE0KGsq9bD8OHDbWFhYS/DFRHpX/75z3/usdaO6KpO3JODc5la8FI1X8Rla7XGmEpnpqQv4qO+KGUnMcbMBGYCFBQUsGHDht4HLSLSjxhjtnZXJ2ED0k730nTnuZdAl1IzJ08Q6jFr7XJr7URr7cQRI7pMfCIicooSNSA9mcBiWs1h3UV+IHwiTX3Ex+qjlImISB+Le3JwksESoN4Y47PWXmiM8TvvFeCsx2+MqQduN8bUQmDFR2NMVWRZvOMTEZHu9dkM6eA6MuEDzMHle8PHJTori2bixIlWYw6SLlpaWti2bRtHjx51OxRJEzk5OYwbN46srKyTyo0x/7TWTuzqswnpVuqM0wpoiChr5sTgddQykf5g27Zt5ObmUlhYiDHG7XAkxVlr2bt3L9u2beOMM87o8ec1Q1okSRw9epRhw4YpMUhcGGMYNmzYKbdEUzo5tB865HYIInGlxCDx1Ju/p5RODq3bG9GqsiIi8ZfSycEeP8aRlzQ8IRJvZWWJWb2moaGh2203N3d/S4fm5mbKysqoqTn1//91dXVMmjQp5ri6snTpUsrKyli7NtoNDmMX/v17G1dvpHRyMJlZ7K/ozU3JRCRSc3Mz1dXVcTnQRSooKGDFiq7/z1ZXV3e7Ha/Xe0qDrOGKik7MxY0lrq5UVlayZMkSSktLexUTnPz9extXb/TZ1UqJ4Bk6lKN/+yvH3nidAeee53Y4InGz9/vf5fimN+K6zexzzmXYXd/qtl5tbS0LFy6ksrKSyZNP3IW0pqaGwsJCfD4fXq+3w+vm5mZqa2spKTn5rqfB8sLCQvx+P3DiwFxTU4PP5zvp9eLFiyksLAyVNTQ0UF9fH9pucHtdCY+tvr4+VO7z+Sgo6Hgb8rq6ulBcwec+nw+/3x81jvB9+f3+0AOgsLCQ2tpaiouL8Xq9UbcZ+fOpr68/6fuHxxVeNxhDV9vtrZRuOXjyh2IGDqJZrQeRuJoyZQpVVVWh1xUVFZSUlOD3+6mtre3wuq6ujurqakpKSli6dGmoa6Suro6qqipKSkq4/PLLKSoqYu7cuUCgKyZ44J43bx5A6KAXPMgFt1tcXMyiRYuoq6tj5cqVlJSUsGXLlk5jj4ytqKiI6dOnh5JTRUXHO56Gx1VUVMTllwduZb1ixQrq6uo6xBGupKQklHSC2/F6vVRXV4eSWGfb7OznE/n9w+Pq7GccbbvxkNItBzwecqdOoflXq8ifeweZo0a5HZFIXMRyhp8IwbNjgOLiYioqKpg2bRp+v59JkyYxdepU5syZQ21t7Umvp06dSmVlZehzK1euZM6cOSxYsCBUvnHjxpP2NWfOHCoqKqivr4/aEliwYAHz5s0LvR++vWjdSpGxAqHWTVFREQsWLGDatGld/hwKCwspKCggPz8fv9/P4sWLT4rjVERuM/L7RP58IoXXDf8Zd7bdeEjplgOA97rp0N5O86qfuR2KSMqrr69n2rRplJSUUFZWFjoYTZkyhTVr1lBYWMjSpUs7vPb5fKHWgt/vx+fzAZxUHil4Bh/sumpoODFHNry7pLi4mJKSEubPn9/l9oIiY4uHyDjiJdr36awFEO1nnCip3XIAssaNZ9CnP8uBX/+Sr1Su5ZjJiGlAS0ROVldXR2VlZaifvLCwkKqqKtauXUttbW1osLW0tJSVK1ee9DrYDRXsNw+esS9ZsiRUDif6xhsaGkL98sFxh/r6egoKCiguLqa+vp6ioqIOnw9/vWXLFnw+X4cxgMjYIHAwrampob6+noULF4a+bzCW4HhB5PPgPiLjCN9ncDt1dXUUFRVRXFxMTU0NGzduDMUXvq/wuDvbbvj3D//cwoULO/yMo203HvpsbaVECK6tdPSVjWy//mqeHuTluZzBSg6Skl5//XXOO08XViTCpEmTWLdundthuKKzv6tY1lZK+W4lgJwPXsiAD17IZ48eIiOFk52IxF/42bXELi2SA0DejBt55N1GqmtqmD17ttvhiEiSKCoqYuPGjZ1ewirRpU1yGDTp0zyzbz8WeOyxx9wOR0QkpaVNcjAZGRSPGokHuPGLX3A7HBGRlJbyVyuF851zLn89bRhjBw/AWqsVLkVETlHatBwAnl+/nnPu/hbH6mo5uuHvbocjknClpaVxWc9HJFJaJQeAIVOuxDNsOP6fatxBRORUpVW3EkBGTg7e62fQ9NADHHutjgHnx28hKpH+YNGiRRQWFobWIlq3bh2LFy92OyzpY2nXcgDw/ttXyMj14n9iuduhiKScwsJCpk2bRnFxMStWrAjNKO5OLPdhCK9bU1MTekjyScvkkDFkCN5rrufw8//F8bc2ux2OSMJs3ryZ9evXx3VuT3AMY8GCBSxcuBCv1xvT56KteBqurq6OhoYGvF5vaDXT4NIRklzSMjkAeK+9HjNwEP7lj7odikjCNDY2AvGd21NQUEBZWRllZWU9uj9AQUEB9fX1UVsQixYtwufzhZaYjnwtySXtxhyCPL58vNdcx/4nH+f4zFvIft8Et0MSibsxY8bQ2NhIeXl53LZZUVHBpEmTKCoqoqGhocPM4pqami7XL7v88stZs2bNSS2OioqK0NLSa9as6fBakk/aJgeAvOk30Lzq5/h/8ggjH1jidjgicTdhwgQmTJjAsmXL4rK9iooK/H5/aFXV2traDsmhpKQk6sqfixYt6pAYILAUeLC7KrgCa/hrST5p260EgdZD3nXTOfTsnzj+5ia3wxFJanV1daxYsSK05PTUqVMpLi6O+fPBZbg7G6OYMmVKaHnu+vr6Dq8l+aTFkt1daWvez7ufu5SBH/0EoxY/HDpb0bLekmxOZcnuZPp7bm5ujnnwWvrOqS7ZndbdSgAebx55183A/5NHOPbG626HIxJXyZAUgpQY0ktadysFea+bHpj38OjDbociIpIS+kVy8Hi9eKeXcXjd82zf9EbcrwsXiZdU7uaV5NObv6d+kRwA8q6ZRkaej7d27AR0zwdJPjk5Oezdu1cJQuLCWsvevXvJyck5pc+n/ZhDUMaQIeSVfZVr/m8TT+/bH9frwkXiYdy4cWzbto3du3e7HYqkiZycHMaNG3dKn037q5XCtR89ysaPXsi+DA+f+Z9Xdb8HEemXYrlaKSHdSsaYEmPMZGPM5LCyyc6jqKdl8ZKRk0PVoFze19bC4Reei/fmRUTSRtyTgzFmGuCz1q4FyowxBc6BPlTm1IupLN4WvfgyWWeeRdPSB7GtrYnYhYhIyktEy6EeKHSe+53npU45QJOTBGItiyuTmUn+3K/RsuUdDq6pjPfmRUTSQtyTg7W2xlq71Hnps9bWAL6Iar4elMXdoNJPM6D4QpoeXUr7kSOJ2IWISEpL2KWsTvfS9ARsd6YxZoMxZsOpXtVhjGHo3Dtp27WL5md+FucIRURSX6IGpCcDVdbaZqdrqD6iSn0Pyk5irV1urZ1orZ04YsSIU44x58MTGXTJJPY/uZw2f9Mpb0dEJB0lYkC6CFgCrDHGbLTW1gFVQKkxxgtgrW3oQVnC5M+9g/ZDh/A/+kgidyMiknL6bJ6Dc8AvdsYgelQWTU/nOXRmz3cXcmD1Lxm7ei3ZZ72vV9sSEUkFrs1z6Iy1tjnygB9rWSLlz7qNjEGD2PfA/X21SxGRpNdv1laKxpM/FN/Nt3LkLy9y+MX1bocjIpIU+n1yAPBefQ1Zpxey74H7sS0tbocjIuI6JQfAZGUz9M67adnyDs2//oXb4YiIuE7JwTGwpJScj38S/48f1qWtItLvKTk4jDEMu/Nu2g8eoGnZ0u4/ICKSxpQcwmRPOBvv1ddy4FerOPZ/r7kdjoiIa5QcIuTPnotn6DD23rcQ297udjgiIq5QcoiQkZvL0Du+wbHX6jjw21+7HY6IiCuUHDox+POTyZn4EZqWPEhb0z63wxER6XNKDp0wxjDs3+fTfugg+x76kdvhiIj0OSWHKC776k38Z+YADlau5ugrG90OR0SkTyk5dGHNwCF4Ro5i733f0cxpEelXlByi2Lx5M8/WvMh9g30c3/QG+3+2wu2QRET6jJJDFI2NjQA8+Yc/MujTn8X/6CO0bK13NygRkT6i5BDFmDFjACgvL2fYN7+Nyc5mz6Jv01f3vxARcZOSQxQTJkzgkksuYdmyZWSOHEX+vG9w9B9/5+BvV7sdmohIwik5xCj3yqvIuegj7Hvw+7Tu2ul2OCIiCaXkEEV1dTXV1dWh18YYhs+/F3v8OHu/d597gYmI9AElhx7IOr0Q3y23cvj5Zzn0X392OxwRkYRRcuihvOvLyD7vA+y57zu07dPSGiKSnpQceshkZTHivvtpP3iAPfcu0NVLIpKWlBxOQfaEs8mfPTfQvfSHtW6HIyISd0oOpyhv+g1szsxi67fuonXHDrfDERGJq5iSgzEm1xhzsfP8VmPM+YkNK/kZj4efDvbhsbDnO99S95KIpJVYWw55wH5jzK3AVqAwYRGlkL+8s4X3v7qJr//6NxxY/Uu3wxERiZtYk0OhtfZV4ApgHeBPWEQppLGxEQusampm3wPfp6Vhq9shiYjERUzJwVr7kjHmeqASyAcmJTSqFBFcf+mm6dMwmZnsvvtOLe0tImkh5gFpa+3PrLUPW2vftdbem8igUkVw/aVHV6xk+IJ7OfZaHU0/ftjtsEREei3WAenzw58bY76QuJBS0+DLPseQqV9i/5PLOfK3v7odjohIr5iurrIxxuQCpcA8wALGeWujtfaOhEfXjYkTJ9oNGza4HUZI++HDNF59Be2HDzH212vw5A91OyQRkQ6MMf+01k7sqk6XLQdr7QFr7e+ABdbaT1trL3UerieGZJQxaBAjvv8gbfua2POde3R5q4ikrFgHpF9MdCDpYsB572fo7XdweN3zHPjVKgBKS0spLS11NzARkR7IjLWiM+7gc14WW2sf6aJuEVBqrV0aVrYC2AL4g+XGmMnO2/XW2rpoZanGe910jrz8EvseuJ8BxR9yOxwRkR6LdUD6AuAGApewTgKiHvGMMV6gHpga8dZGoDosMRQBPmvtWqAsWlkqMhkZjPjuD8jIy2PXHXN45803Wb9+PbNnz3Y7NBGRmMR6KasfeNBae69zGev8aBWttc3W2uZO3qqPeF0aVtYUbG10UpaSPMOGMfIHi2l9bxvvbd8OwGOPPeZyVCIisYk1OfiAGmPM88aYF4A1p7i/WmNMZdg2I/fRWVnKyvnQRPLnfI1rhuZhgPLycrdDEhGJScxjDtbaM4PPnW6mmDldTdXW2mZjjK83LQJjzExgJkBBQcGpbqbP5M24kamPLGX+2GOMn/lVt8MREYlJrFcrvWqM+bYx5h6nKK+H+5kBTIkoq+/kdWdlkbEst9ZOtNZOHDFiRA/D6HvGGH462EdThoddd95OW5PuHiciyS/WAemLgYeA9THU9RpjSgCf8y9AFVBtjCkAap2rkKqAUqdVgbW2IUpZyvtjTQ0ffOZXtO3by+5vfh3b1uZ2SCIiXYp1zGErcDlgjTFDgDOiVXQGpGustRdaa2ucsuBB3metnResRyDhFFtrF0UrSxcD3n8+w+76FkdefommZUu7/4CIiItiGnOw1r5rjHkFWAg0AXN7uiMnQTRElDUDNd2VpYvcq67m2P/9L/t/+hMGnHsegy/7nNshiYh0Kqbk4EyA22KtvSLB8aQ1YwzD/30+LW9tZve3v0nWGWeSPeFst8MSEekg1m4lA0wyxlwcvF2onBqTnc3IB5eSMXgwO+fOom2/3+2QREQ6iDU5bHEW4NsK3GCMeT6BMaW9zJGjGPngUlp37GD3XXdogFpEkk6syeFCZ/Lbd4AV1tpPJy6k/iGn+EMM+/f5gQHqhxe7HY6IyElinQTnBy631h5IYCz9jvdL/8bx1/+X/U8+TvaEcxjy+S+6HZKICNCDSXDA7cFJcBp3iJ9hd3+LnA9fxJ4F/86Nn/yElvYWkaQQ90lw0jMmKzBA7Rl1GrcdbGJYW6vbIYmIxH8SnPScJ38oox75Cd/ftoOql/7CrJkz3Q5JRPq5Lu8hfVLFwGJ7oUlw1tqDiQwsFsl2D+neyjAGC3iMoeX4cUxmzOsiiojErNf3kA5nrX3VWnuFtfbGZEgM6Wj0mDEY4Cv5XvY9cL/b4YhIP6ZT0yQyYcIEJkyYwEOf/xeaf7aSrMIz8F59rdthiUg/pOSQRKqrqwGwbW20bN3K3vvvI3P0GAZdMilUJ3g1U7CuiEgidNmtZIz5gjMALX3IeDyM/MGPyD73PHZ9fR7HXqtzOyQR6We6G3OYCmCMGRde6CzEJwmUMWgwpy1bjmfYMHbMLqelYSsAmzdvZv369cyePdvlCEUknXV5tZIx5jYCCSKPwCxp47yVZ639cMKj60a6Xa3UmZb6LTROu5qMXC9jKn5B5vDhAHg8HlpbNSdCRHqu11crWWsfttZeCtxurf20tfZS5/WMOMYpXcgqPINRD/+Etl072XFbOeNGjwagvLzc5chEJJ31ZJ7DEAJJwW+t/Xkig4pVf2g5BB1a9xy75t1GrSeLh4fk88J6TVYXkVMT13kOQBnwCrDfGHNrryKTHhs86TMM++a3KW45xi9LLybWpC4icipivRPcxdbah8NefypxIUk03i9fQ+uunex//Cd48vLIn/d1jDHdf1BEpIdibTm8Yoz5AoS6l05PXEjSlfxbbyf3y9ewf+UT7H9iudvhiEiaiqnlYK09YIzZaoz5LYG1lRYkNiyJxhjDsG9+m/YDzTQtfZCM3Fy8X77G7bBEJM3EPEPauafDFQmMRWJkMjIYce/9tB88xN7/WERGrpch/+8LboclImmkJwPSkkRMVhYjH3iInA9fxO577uJwTbXbIYlIGlFySGEZOTmMWvoo2eecy6475nDkH38LvVdaWqq7yonIKYv1TnC5wQFpSS4ZQ4Zw2o8fJ3PceHbOLufoP/vHvA8RSaxYWw6FQH3whdZWSi6e/KGM/ulTZI4ezY5ZN3F04z+1BpOI9EpMM6Sdu8CtAbYQWF9Jayslodbdu9hxw/W07tnNmf+9MXBXOa3BJCIR4n0nuDOD6yuhtZWSUuaIkZz20wo8w4bz5aE+DFqDSUROTUzJwVr7qjHm28aYe5yivATGJL2QOWoUo39awe3jR/Nq0Tk8OOtmt0MSkRQU64D0xcBDgFZ7SwGZp53Gh//zObyjx7Bj5g26WZCI9Fis3UpbgcsB6yyfcUbiQpJ4yBw9htOeqCDD62X7TTM4+j8amxGR2MXarfQugRVZvwYsASoTGZTER9bYcYxe+QyZI0ay4+avcuS/X3Y7JBFJET0ZkH7VWnuFtfZGa+3BRAYl8ZM5ahSjV/yczPHj2XlruWZSi0hMYk4OxpjrjTG/Ncb8prt5DsaYImPMnIiyyc6jqKdl0jueYcMZ/eTPyJpwNjtvn82hZ//T7ZBEJMnFOiA9Hqh1Wg5XAhd2UddLYMLc1LCyIsBnrV1L4KZBMZdJfHjyfIxevpIBFxSx6xtf48DaKrdDEpEkFmvLIY/ABLigLdEqWmubrbXNEcWlnJhh3eQkgVjLJE4ycnM57dEnyLnoo+y55y72P/Wk2yGJSJLqcsluY8wLgCUwK9pnjGlynm8BXurBfnydvI61LDKmmcBMgIKCgh6EIAAZgwZx2rLl7Prmnez70fdp27M7cEe5DK3BKCIndHc/h7nOfRyShrV2ObAcAstnuBxOSjLZ2Yz8wWKe+NhEPv3Uk7Tt3cvwhd/FZGW5HZqIJIkuTxfDE4Mx5nxjzMXO49Ye7qe+k9exlkkCGI+HBe/t5H2vvsnXHlvOzrmzaD982O2wRCRJ9GRA+gZgkvP4UBd1vcaYEgLdUCVOcRVQ6gxWY61t6EGZJEjj9u20A6v8Bzjy8kvs+Op02pr2uR2WiCSBnqzKuiU4v8EYM96ZGBf7jgIH/GJrbU1Py6LRqqy9M3bsWBobG5k1axY/+NJUdn/ja3hGjmLUI4+RfcaZbocnIgkSy6qsMSUHZ2MPAsHTyjOstTf2Mr5eU3LoneCd4qqrqwE4+spGds6ZBa2tjFz8MAM/8jH3ghORhInbkt1Oy2EdgYX31gO1vY5OXFddXR1KDAA5H7yQMU//Cs/Ikey4+UYOVK52LzgRcVWs1y/6gY3W2hettS+itZXSVta48Yyp+EVgLsSCb7HvoQew7e1uhyUifSzW5OAD1hpjnnfmPqxJXEjitozcXE575DFyr/oy+598nF13zNWVTCL9THfzHEKstaErlJxuJkljJiuLYfcsJKvwTPb88Htsqn6Bj//uT2SNG+92aCLSB2K+E1xXryU9GWPIu34Gi4cMJb+9jcarr+TwX150OywR6QOxDkgPCZsAdyqT4CSFVW5t4IN1m5jfuIuds2fif3I5sV7lJiKpKdYxhws5MQEu+JB+orGxEQs83bCNwZ/9F5oe+hG77pxL++FDbocmIgkS65hDrXOVEgDGmE8lKB5JQmPGjKGxsZHy8nJG/GAx2e8/n6YlP6LxnbcZ+cASss96n9shikicxZocCo0xSwis0AqBeQ7qfO4n3nvvvZNe+8q+yoDz3s+uu+6g8StfYtg93yF38hR3ghORhIh5+YxkHITWDGl3te7aye677+Tohr/zYvZAfj7Yy7Pru131RERc1usZ0saYL4CuTpLOZY4cxWnLV+Arn8WzW+p5vuZFbr7uOrfDEpE46G5A+gzn6qRPBa9SMsbsNcbc0yfRSdIzmZnkz57LM/v20w789OmnOfCbX+tqJpEU111yWGmtfckZjJ4EfA0otdbel/jQJJWMHjMGA1x33tnsWXgPu+bdSts+Lf8tkqq6u9nPAWPMOGfJDB/wQXUxSWfee+892q1lxWuvM/SOuzj84nreu/KLHH5xvduhicgp6G7M4XoCq7DOt9beYa094JSP64vgJPWYjAzypt/A2FWrycgfys7ZM9nz3YW0Hznidmgi0gPddStNAm4HTNjs6E8B8xIemaS07LPPZcyq1XinlXHgl8/Q+OWpHK17xe2wRCRGXV7KGu0S1mS5tFWXsqaGI//9V3Z/+27adu/iT9kDqRyYy7Pr1d0k4pZeX8oaLQEkQ2KQ1DHwYx9nXOUfyL3yKl5++x2er6mh/Kqr3A5LRLoQ821Ck5FaDqknwxgs4AF23Pcdht5+BxmDh7gdlki/ErfbhIrES/CS1+kf/xgHfrWKbVd8kcPr13WoV1paGrrHtYj0PSUH6VMTJkyg5JJLeOLlvzK6YhUZgwax87ab2Xn7bFq3N4bqbd68mfXr1zN79mwXoxXpv9StJK6yLcfZ/7OV+H+yDDD4bp5N3vUzyMjOBsDj8dDa2upukCJpRt1KkvRMVja+G2YytuqPDPz4J2h66AHe+7epnDdqFADl5eUuRyjSP8V8D2mRRMoaM5ZRS37M4eoX2Hv/ffxhZB6DZ1zL0NvvdDs0kX5JLQdJKoNKL2Xsb39P3k03c/i5Z9k2+XM0PfqIZliL9DElB0k6GYMGMfS2eYxd+ycGXTIJ/6MPs23y5zj4h7XY9na3wxPpF5QcJGlljRnLyB8+xOiVT+MZNozd3/w626+/mqOvbHQ7NJG0p+QgSS/nQxMZ88xqht/7PVq3N7L9+qvZeftsjr/9ltuhiaQtJQdJCSYjg9zLr2Dc7/+M79a5HPnbX3l36uepmFh80vwIEYkPJQdJKRmDBpM/cxbj//gcN+zcxw3/fIWyovPZ+8Pv0dakmwuJxIuSg6QkT/5QanbtoQ1YtddP89MVvPv/PkPTsqW0Ne93OzyRlKfkIClrzJgxAJTfcgtjV69l4Mc+gf+xZbz7uUtpWraEtv1+dwMUSWF9tnyGMWYFsAXwW2uXOmWTnbfrrbV10cqi0fIZEunYpjfw/2QZh59/FjN4MN5rridvWhmePJ/boYkkjWRbPmMjUB2WGIoAn7V2LVAWrUykJwaccy6jFj/M2NVrGPiJi9n/+E/Y9KmPsfQjH9KYhEgP9GVyqI94XRpW1uQkhs7KRHos++xzGfWjpYxdvZZ5O3bztX9spOzcCez93r20vLetQ30tES5ysr4ec6g1xlQ6z30R7/milJ3EGDPTGLPBGLNh9+7d8Y5P0kz22efw7O59tAHP7G6i+de/ZNsXLmPX3XdwbNMboXpaIlzkZH2SHIwxXgJdSs2ArzctAmvtcmvtRGvtxBEjRsQvSElb4QPX4//4HN5rp3O4+gUar7qcHTffyJG//zeNjYG5Eo899piboYokjb5alXUG4AcqwsrqI+rURykT6ZX33nvvpNfD7rwL38ybOfDLVex/uoIdX53O5GH5/G5vE+U3fdWlKEWSS191K1UB1caYAqDWuQqpCih1WhVYaxuilInEncebh++mmxn/53UM+/ZCHvn4Rbx9wdnc9eZrNC3/MW1797odooir+vJS1gICVyLVhZV5gWJrbU1XZdHoUlaJF9vezpG/vEjz0xUcefklTHY2g//1C3ivncaAc89zOzyRuIrlUlbdJlQkwvF33qb56QoO/m4N9ugRcj58Ed5rpzGo9FJMpu6PJalPyUGkF9qa93Pwt6tp/sXTtDa+h2fUaeReeRW5V1xF5shRbocncsqUHETiwLa2crj6BZp//QuO/vUvtAG5n74M779dTc5HP47J0Co0klpiSQ5qI4t0w2RmMvgzlzH4M5fxvtGj2bJjB9fu8bPw+WfJHF9A7pe+TO7lV+AZOtTtUEXiRqc8Ij3w9o4dtAPP7NrLiO89gGfESJoW/5CGz5aw6+47OLLhH6Rya1wkSMlBpAdmzZqFx+OhvLycIZ//ImNWPs3Y3/4e71VXc7immh03XMe2yZ/D/8RyWnfvcjtckVOmMQeROGk/fJhD//VnDlSu5tj/bACPh4GfLCH3ii8x6FOXYLKy3A5RBNCAtIgrxo4dy/bGRm64+BPMzza07d5NxtBh5H7xcoZM/RLZZ54FEFror7q62r1gpV9SchBxgTEGAI/HQ8vRoxz5y4scqPoNh9evg9ZWBhQVkzv1S3zgtrm8u307s2bNYtmyZS5HLf2JkoOIC8aOHUtjY2OHg37b3j0c/P1aDlSupuWdt5nw6pu0AZ6MDFqOHlW3k/QZJQeRJGSt5VjdK8wun8lTf/sHXxmax33nn8eQf/08Qz4/mezzLwi1PkQSQclBJMnZluMcfulFDv1hLYerX8AeP07W6YUM/sJkhnx+MlnjxmtsQuJOyUEkhbQ1N3P4uT9z8A9rOfqPvwMwoPhCpv75Bf6xaze3aGxC4kTJQSRFtW5v5OAff8/BP/yOwsrfB8YmjGHf0xUM+sxlZI4Y6XaIksKUHETSwM3XXcdPV63i2tPH850hA8AYcj40kcH/8q+BRDF8hLqepEeUHETSzPG33+LQs3/i0LP/Scvbb4USxdQ/Psvf1fUkMVJyEEljx9/aHEgUzz17UtfTrsUPMKj0UgZcUKQVY6VTSg4i/cQt06fz+M9/znVnv48FOR5oa8MzbDgDL5nE4NJLyfnIR8kYNNjtMCVJKDmI9ENt+/0ceamGw9UvcPilGuyhQ5CZRc6FFzLwE59i4Mc/Sfa556lV0Y8pOYj0c/b4cY7+zwaOvPwSR15+ibvX1bBq336uGT2KB6ZdG0gWH/u47mzXzyg5iMhJMozBEhibePtTH6W9aR8AmQWnk/PhiwKPiReRNWasu4FKQsWSHNSuFOlHbgnej+KWWyhY9xfG/OK3DL3jLrLPPIvDz/8Xe+65ixsu+AAeY7jhwxdy4De/5vjmN7FtbW6HLn1MLQcRAcC2t9Py1pvknHNeoHUBbL7gbADMwEEM+MD5DDj/AgZc8EEGXFCEZ9RpWgMqReke0iISM5ORQfbZ53LLrFk89thjlJeXM+7rd3LstTqOvfYqx+peYf/TFdDSAoBn+Aiy3/8Bss8+l+xzzmHAOeeROb4A4/GEthlthVpJfmo5iEjM7PHjHN/0Bsdeq+PKubfzwu69XDPMx6IxgeU8TM5Ass8+h+xzziH77HPxXX1toBXi8dDa2upu8BKiAWkRSZjwmxodqnuF45te5/imNzj+5iaOb3qd9gMHmP/eTlbt28+1Y0/j/s9dRtaZZ5F95lmBf896HxlDh2GMUQujjyk5iEjCzJ49O9T9FHlAt9bSur2Rljc3cfydt2nZ8g4tb7/F8S1vB+ZdODK8eWSddRbjK35BO4EbHx3e9AaZ4wvIGDCgj79R/6HkICJJxVpL286dtGx5m+Nvv+X8+zZ3P/s8z2zfyVeG5rFo7CgwBs9po8k6vZCsgtMD/zrPM8eO013zeknJQURSRltzM60N9bRs3UpLw1ZaGupp2VpP69attB9oPlHR4yFz7LhA0ig4nazCM8gsOJ2scePJHD1GiSMGulpJRFKGx+vFc34RA84vOqncWku7v4kLzns/b+zcyQ2f+iT/cd77adlaz9F/bsAeORy2EQ9ff3c7lXv9zLjow/zo5plkjSsgc9x4ssYXkJGb28ffKnWp5SAiKSF8ADx45ZO1lrY9u2nZupXW996l9d0Ght82LzB+wYl5GkEZeT4yx48na9x4rnzq5/xl1x5u+tKVLHv4YTwjR/Wb9abUchCRtDErbP5FkDGGzBEjA3fGm3gRADe/vjlU7/Tvf5+Wbe/Suu1dWt5tCPy77V2O/e9r/HXXHizwxOrfcPemVyEri8zTRgceo8eQOXo03/j9H1nx7HN89Zpr+PHy5WQMHOjSt+97ajmISL80+5ZbeOzxx7lxyuX88MtX0brtXVq3b6d1RyOt27fTtnsXE155I3CfDAKtkIz8fCdxjAklEs/wEdyx8imeqKxiZlkZy5YvT/qZ4yk5IG2Mmew8rbfW1nVVV8lBRBLFtrQw66abePxnP+OGz/0LP5gyOZQ4Wrc30trYGBrvmPDqm6Ek8tZFRXiGj8AzYgSe4SPIHDEy8Hr4cDy+fDJ8vtC/Gbnek2aU95WUSw7GmCKg2FpbYYxZbK2d11V9JQcRcYu1FnvwIK17dnHb17/BE5VVlJVewv3/ehltu3fTtmcXbbt307pnN/bgwdCEwNDlugDGkJGXhyfPR4Yvn4w8H9f9ajXrdu+l7OJP8sCMaWQMHowZNJiMIUPIGDQ48HrwYEx2NiYzK/Cv8yArK6ZWSyomhzlArbW2xhgzH6jqqvWg5CAiqaD9yBGyc3Npa2vDk5GBf20lbX4/7f6mwL/7/bQ1NdG+38/pq9fQZjsfUA/qNNEEZWZhsrMwnkzueuMtVu/zc81pI7l3QmHgfWMorPlbyg1I+7p5LSKScjIGDqS8vDw0UD7k85Oj1i0Pm3l++o9+hD10iPZDB2k/dIj2Q4ewhw6y6tLP0Aas8h9g2SOPYI8fP/FobcEePw5tbaz+63zagGd27ubB22aDtYFHzd+6D9pamzQPYD5QEvk8os5MYAOwoaCgwIqI9DezZs2yHo/Hzpo165TqARtsN8fjZOtWmkZgIDrYrbTSWtsQrb66lUREei4V7wRXBZQaY7wAXSUGERFJnKRKDtbaZuAhAlcsLXI5HBGRfivZBqSDCaLG7ThERPqzpGo5iIhIclByEBGRDpQcRESkAyUHERHpIKnmOfSUMeYAsMntOBJoOLDH7SASSN8vdaXzd4P0/37nWGu7vPNR0l2t1EObupvIkcqMMRv0/VJXOn+/dP5u0D++X3d11K0kIiIdKDmIiEgHqZ4clrsdQILp+6W2dP5+6fzdQN8vtQekRUQkMVK95SAiIgmQslcrGWNKcG4GZK1d62400hPGmBXAFsBvrV3qdjzx5tzutpDA90urdcKc7zYlrKjLuzWmIuc7+gDS8PcXPG7Wd/d7S8mWg/PLK3OSwlNux5MIxhivc3+LdLQRqE7HxOCY4vxtLnE7kATwAdXOww/UuxZJAgQTg5MUSl0OJ66CicH525zSXf2UTA5Oxlvs3Peh1uVwEmUGgbPPdFTvdgCJYoyZDNQaY0qstRe6HU8C1DoHzloCCb7Z5XgSYaFzbPG7HUiclRL2nZxEGFVKJgeHn8ABdLG7YcSf80urdzuOBKs1xlS6HUQCFAOTwu5mmFbCksGUdOtOgtCJZyWwn/RLDtU43WXAGWHPO5WyycFa2+B0Syw0xhS4HU+8BO+CR/r9YQKh7xc84/R1d/aSokJJLx2/n/M7TMdWUfD3VQ18EJiXTseW4PiJ073UrZRMDsaYOWFnnX7Sq/tlBoGMXgyckU5/nI4ZxNDfmcJq6eaMLA1MAZrcDiJBplhr65wWxALS6NgSdvvlmvB/o0nVq5WqCXRLnPRl00FwkNYYA4HBo3S7j3YVgJP0atOta8Jau9bpTlrrvE6r7+codDuABFppjJnsDNoGB2/ThQ8oNsbUA+u6q5yyk+Ccg0thOiWGICfpzSDQdF+QbgnC+d350vTAGfz9Fafj3yacdAaajoPRaf37C/ZExHJMSdnkICIiiZOSYw4iIpJYSg4iItKBkoOIiHSg5CAiIh0oOYjEIFnnmyRrXJL6lByk3zDGFBljur2+u5PPFRB2bb+znTld7GNF5KKJxphpTnlRMI7wOs77cyI+syLK9kP1rLUNabxAo7hIyUH6jV7Mq5gRtvSAl8C6V1O72Mc6YGHEW4UE5uUEZ9/6I94/aflyZz+lzkJ+4WWd7lstCIk3JQfpt5xl0UsiygrCzu6D6yLlB9+31jbHMPmrHqgPbtvZTm1EnRVAWdhrf8T7xQSWbwglgi72XUVg0qRI3Cg5SL/kHLBLndVT54QliilOlSlOvRJObR2h8IO/j4iDv7MsQ7GTjAoi33dUEcM6VE7CmHQKMYpEpeQgac0YM995RK5EuTBs3ZxaTtw/o955nBFrN1Rn+7DWVgBTujjwA6wM7jd8X2FjHMUE1hDTmIL0uVRdeE8kJtbaRVHe8htjvMGlwzlxVzMfgZuizI3DPqoIJKGyKMskLwbWE1hIMlyhk1yCg9JTgYpY4xGJB7UcpN8I3gLSOTNfQODMvoSwgzGBgeR5wBInedQQNuYQ1v3k6+yA7+xjqrOPxcDG4EJuRNy/wln8zE/YeETY54P39ah34pwcbd9O3R5fhSXSFS28J+IwxswJWzI9OCax1Bgzv4vWQW/36Y1hgLu7bUwjcAOltFq9V9ylloPICfVhZ/aFnOjuWRnr3bN6Kl7LXisxSLyp5SASJmwwuDb8wG2MKUjGA3CyxiWpT8lBREQ6ULeSiIh0oOQgIiIdKDmIiEgHSg4iItKBkoOIiHTw/wGwjUlSPhCBDAAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#MVA1\n",
    "\n",
    "#Paramètres\n",
    "cut_var = 'EVT_MVA1' #\n",
    "\n",
    "cut_min = -np.log(1-0.95) \n",
    "cut_max = 9\n",
    "\n",
    "nb_bins = 35\n",
    "cut_vals = -np.log(1-cc_df_1[cut_var]) #\n",
    "\n",
    "\n",
    "#Programme\n",
    "label_hist = r'$Z \\rightarrow c\\bar{c}$' #\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "counts, bin_edges = np.histogram(cut_vals, bins=nb_bins, range=(cut_min, cut_max))\n",
    "print(counts)\n",
    "\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2\n",
    "err = np.sqrt(counts) #erreur en racine(N)\n",
    "#print(err)\n",
    "\n",
    "#Normalise\n",
    "#err = err / np.sum(counts)\n",
    "#counts = counts / np.sum(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', color='k', markersize=2, label=label_hist) \n",
    "\n",
    "#Cubic spline of the MVA distribution\n",
    "weights = 1./err\n",
    "print(weights)\n",
    "spline = interpolate.splrep(bin_centres, counts, w=weights)\n",
    "\n",
    "cut_vals = np.linspace(cut_min, cut_max, 1000) #pour avoir une courbe continue\n",
    "spline_vals = interpolate.splev(cut_vals, spline)\n",
    "print(spline_vals.max())\n",
    "\n",
    "plt.plot(cut_vals, spline_vals, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(cut_min, cut_max)\n",
    "plt.xlabel(\"-log(1-MVA1)\") #\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow c\\bar{c}$ data with MVA1$>$0.95\") #\n",
    "#plt.ylim(0,counts.max())\n",
    "#plt.yscale('log')\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n",
    "#pickle.dump(spline, open('cc_MVA1_spline_log.pkl','wb')) #:)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "id": "round-component",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[2.9957323 3.1101398 3.2245476 3.3389552 3.453363  3.5677705 3.6821783\n",
      " 3.7965858 3.9109936 4.025401  4.1398087 4.254216  4.368624  4.4830317\n",
      " 4.5974393 4.711847  4.826255  4.9406624 5.05507   5.1694775 5.2838855\n",
      " 5.398293  5.5127006 5.627108  5.7415156 5.8559237 5.970331  6.0847387\n",
      " 6.1991463 6.3135543 6.427962  6.5423694 6.656777  6.771185  6.8855925\n",
      " 7.       ]\n",
      "[927 831 732 636 544 468 454 334 300 291 241 175 165 118 110 106  92  74\n",
      "  61  43  30  40  25  25  12  11  14   7   6   6   4   7   5   2   3]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#MVA2\n",
    "\n",
    "cut_var = 'EVT_MVA2' \n",
    "cut_min = -np.log(1-0.95)\n",
    "cut_max = 7\n",
    "nb_bins = 35\n",
    "\n",
    "cut_vals = -np.log(1-cc_df_2[cut_var]) #\n",
    "\n",
    "\n",
    "label_hist = r'$Z \\rightarrow c\\bar{c}$' #\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "counts, bin_edges = np.histogram(cut_vals, bins=nb_bins, range=(cut_min, cut_max))\n",
    "print(bin_edges)\n",
    "print(counts)\n",
    "\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2\n",
    "err = np.sqrt(counts) #erreur en racine(N)\n",
    "\n",
    "#Normalise\n",
    "#err = err / np.sum(counts)\n",
    "#counts = counts / np.sum(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', color='k', markersize=2, label=label_hist) \n",
    "\n",
    "#Cubic spline of the MVA distribution\n",
    "weights = 1./err\n",
    "spline = interpolate.splrep(bin_centres, counts, w=weights)\n",
    "\n",
    "cut_vals = np.linspace(cut_min, cut_max, 1000) #pour avoir une courbe continue\n",
    "spline_vals = interpolate.splev(cut_vals, spline)\n",
    "\n",
    "plt.plot(cut_vals, spline_vals, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(cut_min, cut_max)\n",
    "plt.xlabel(\"-log(1-MVA2)\")\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow c\\bar{c}$ data with MVA2$>$0.95\") #\n",
    "#plt.ylim(0,counts.max())\n",
    "#plt.yscale('log')\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n",
    "#pickle.dump(spline, open('cc_MVA2_spline_log.pkl','wb')) #:)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "local-genius",
   "metadata": {},
   "source": [
    "# Z -> uds uds"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "id": "suspected-effort",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 99 110  87  80  83  59  59  66  64  48  44  43  32  42  25  30  17  24\n",
      "  20  16  14  10  12   7  10   4   1   4]\n",
      "[0.10050378 0.09534626 0.10721125 0.1118034  0.10976426 0.13018891\n",
      " 0.13018891 0.12309149 0.125      0.14433757 0.15075567 0.15249857\n",
      " 0.1767767  0.15430335 0.2        0.18257419 0.24253563 0.20412415\n",
      " 0.2236068  0.25       0.26726124 0.31622777 0.28867513 0.37796447\n",
      " 0.31622777 0.5        1.         0.5       ]\n",
      "108.88126916984072\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#MVA1\n",
    "\n",
    "\n",
    "#Paramètres\n",
    "cut_var = 'EVT_MVA1' #\n",
    "\n",
    "cut_min = -np.log(1-0.95) \n",
    "cut_max = 8\n",
    "\n",
    "nb_bins = 28\n",
    "cut_vals = -np.log(1-uds_df_1[cut_var]) #\n",
    "\n",
    "\n",
    "#Programme\n",
    "label_hist = r'$Z \\rightarrow q\\bar{q}$' #\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "counts, bin_edges = np.histogram(cut_vals, bins=nb_bins, range=(cut_min, cut_max))\n",
    "print(counts)\n",
    "\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2\n",
    "err = np.sqrt(counts) #erreur en racine(N)\n",
    "#print(err)\n",
    "\n",
    "#Normalise\n",
    "#err = err / np.sum(counts)\n",
    "#counts = counts / np.sum(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', color='k', markersize=2, label=label_hist) \n",
    "\n",
    "#Cubic spline of the MVA distribution\n",
    "weights = 1./err\n",
    "print(weights)\n",
    "spline = interpolate.splrep(bin_centres, counts, w=weights)\n",
    "\n",
    "cut_vals = np.linspace(cut_min, cut_max, 1000) #pour avoir une courbe continue\n",
    "spline_vals = interpolate.splev(cut_vals, spline)\n",
    "print(spline_vals.max())\n",
    "\n",
    "plt.plot(cut_vals, spline_vals, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(cut_min, cut_max)\n",
    "plt.xlabel(\"-log(1-MVA1)\") #\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow q\\bar{q}$ data with MVA1$>$0.95\") #\n",
    "#plt.ylim(0,counts.max())\n",
    "#plt.yscale('log')\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n",
    "#pickle.dump(spline, open('uds_MVA1_spline_log.pkl','wb')) #:)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 91,
   "id": "valid-jonathan",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[2.9957323 3.2294211 3.4631102 3.6967993 3.930488  4.164177  4.3978662\n",
      " 4.631555  4.865244  5.098933  5.332622  5.566311  5.8      ]\n",
      "[33 32 22 10  8  3  5  3  3  2  1  1]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#MVA2\n",
    "\n",
    "cut_var = 'EVT_MVA2' \n",
    "cut_min = -np.log(1-0.95)\n",
    "cut_max = 5.8\n",
    "nb_bins = 12\n",
    "\n",
    "cut_vals = -np.log(1-uds_df_2[cut_var]) #\n",
    "\n",
    "\n",
    "label_hist = r'$Z \\rightarrow q\\bar{q}$' #\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "counts, bin_edges = np.histogram(cut_vals, bins=nb_bins, range=(cut_min, cut_max))\n",
    "print(bin_edges)\n",
    "print(counts)\n",
    "\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2\n",
    "err = np.sqrt(counts) #erreur en racine(N)\n",
    "\n",
    "#Normalise\n",
    "#err = err / np.sum(counts)\n",
    "#counts = counts / np.sum(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', color='k', markersize=2, label=label_hist) \n",
    "\n",
    "#Cubic spline of the MVA distribution\n",
    "weights = 1./err\n",
    "spline = interpolate.splrep(bin_centres, counts, w=weights)\n",
    "\n",
    "cut_vals = np.linspace(cut_min, cut_max, 1000) #pour avoir une courbe continue\n",
    "spline_vals = interpolate.splev(cut_vals, spline)\n",
    "\n",
    "plt.plot(cut_vals, spline_vals, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(cut_min, cut_max)\n",
    "plt.xlabel(\"-log(1-MVA2)\")\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow q\\bar{q}$ data with MVA2$>$0.95\") #\n",
    "#plt.ylim(0,counts.max())\n",
    "#plt.yscale('log')\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n",
    "#pickle.dump(spline, open('uds_MVA2_spline_log.pkl','wb')) #:)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fluid-trustee",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
