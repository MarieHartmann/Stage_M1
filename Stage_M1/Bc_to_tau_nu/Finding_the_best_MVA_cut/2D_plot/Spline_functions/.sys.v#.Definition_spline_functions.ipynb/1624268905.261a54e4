{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "nearby-franklin",
   "metadata": {},
   "source": [
    "# Nouvelle Méthode pour calculer l'efficacité d'un cut"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "flying-search",
   "metadata": {},
   "source": [
    "Comme on a pu le voir précedemment, pour des hautes valeurs de cut, il n'y a plus aucun évènement de background et on obtient une efficacité égale à 1. Pour résoudre ce problème, nous allons remplacer dans les programmes utilisés la valeur de la longueur du data frame après cut, par la valeur de l'intégrale de la courbe formé par l'histogramme pour la varaible de cut considérée."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "brief-likelihood",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/cvmfs/sft.cern.ch/lcg/releases/Python/3.8.6-3199b/x86_64-centos7-gcc8-opt/lib/python3.8/_collections_abc.py:832: MatplotlibDeprecationWarning: Support for setting the 'text.latex.preamble' or 'pgf.preamble' rcParam to a list of strings is deprecated since 3.3 and will be removed two minor releases later; set it to a single string instead.\n",
      "  self[key] = other[key]\n"
     ]
    }
   ],
   "source": [
    "import pandas\n",
    "import uproot\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "import scipy.interpolate as interpolate\n",
    "import pickle\n",
    "\n",
    "from matplotlib import rc\n",
    "rc('font',**{'family':'serif','serif':['Roman']})\n",
    "rc('text', usetex=True)\n",
    "params= {'text.latex.preamble' : [r'\\usepackage{amsmath}']}\n",
    "plt.rcParams.update(params)\n",
    "plt.rcParams['text.latex.preamble'] = r\"\\usepackage{bm} \\usepackage{amsmath}\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "instant-plaza",
   "metadata": {},
   "outputs": [],
   "source": [
    "bc_tree = uproot.open('/eos/experiment/fcc/ee/analyses/case-studies/flavour/Bc2TauNu/flatNtuples/spring2021/prod_04/Analysis_stage2/p8_ee_Zbb_ecm91_EvtGen_Bc2TauNuTAUHADNU.root')['events']\n",
    "bb_tree = uproot.open('/eos/experiment/fcc/ee/analyses/case-studies/flavour/Bc2TauNu/flatNtuples/spring2021/prod_04/Analysis_stage2/p8_ee_Zbb_ecm91_EvtGen.root')['events']\n",
    "tree_gen = uproot.open(\"/eos/experiment/fcc/ee/analyses/case-studies/flavour/Bc2TauNu/flatNtuples/spring2021/prod_04/Analysis_stage2/p8_ee_Zbb_ecm91_EvtGen_Bc2TauNuTAUHADNU.root\")[\"metadata\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "clean-pension",
   "metadata": {},
   "outputs": [],
   "source": [
    "bc_df = bc_tree.arrays(library=\"pd\", how=\"zip\", filter_name=[\"EVT_*\"])\n",
    "bb_df = bb_tree.arrays(library=\"pd\", how=\"zip\", filter_name=[\"EVT_*\"])\n",
    "df_gen = tree_gen.arrays(library=\"pd\", how=\"zip\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "novel-munich",
   "metadata": {},
   "source": [
    "#### Définition nouveaux dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "underlying-final",
   "metadata": {},
   "outputs": [],
   "source": [
    "cut=0.95\n",
    "\n",
    "bc_df_1 = bc_df[bc_df['EVT_MVA1']>cut]\n",
    "bb_df_1= bb_df[bb_df['EVT_MVA1']>cut]\n",
    "\n",
    "bc_df_2 = bc_df[bc_df['EVT_MVA2']>cut]\n",
    "bb_df_2= bb_df[bb_df['EVT_MVA2']>cut]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "crazy-lucas",
   "metadata": {},
   "source": [
    "## Histogrammes des valeurs en log(1-MVA)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "extended-footwear",
   "metadata": {},
   "outputs": [],
   "source": [
    "s_bin = 3\n",
    "f_bin = 10\n",
    "nb_bins = 50\n",
    "title = r'$Z \\rightarrow b\\bar{b}$'\n",
    "\n",
    "plt.figure()\n",
    "plt.hist(-np.log(1-bb_df_1['EVT_MVA1']), bins=nb_bins, range=(s_bin, f_bin), color= '#3182bd', histtype='step', label=title, density=True)\n",
    "plt.xlim(3,10)\n",
    "plt.yscale('log')\n",
    "plt.xlabel(\"-log(1-MVA1)\")\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA1$>$0.95\")\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "instant-public",
   "metadata": {},
   "outputs": [],
   "source": [
    "s_bin = 3\n",
    "f_bin = 10\n",
    "nb_bins = 50\n",
    "title = r'$Z \\rightarrow b\\bar{b}$'\n",
    "\n",
    "plt.figure()\n",
    "plt.hist(-np.log(1-bb_df_2['EVT_MVA2']), bins=nb_bins, range=(s_bin, f_bin), color= '#3182bd', histtype='step', label=title, density=True)\n",
    "plt.xlim(3,10)\n",
    "plt.yscale('log')\n",
    "plt.xlabel(\"-log(1-MVA2)\")\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA2$>$0.95\")\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "equipped-addition",
   "metadata": {},
   "source": [
    "## Histogrammes des valeurs en log(1-MVA) + splines functions tracée"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "informed-lemon",
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "s_bin = 3\n",
    "f_bin = 10\n",
    "nb_bins = 50\n",
    "label_hist = r'$Z \\rightarrow b\\bar{b}$'\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "MVA1 = plt.hist(-np.log(1-bb_df_2['EVT_MVA1']), bins=nb_bins, range=(s_bin, f_bin), density=True, histtype='step', label=label_hist, color= '#3182bd')\n",
    "x_MVA1_values = MVA1[1][:-1]\n",
    "MVA1_bins = MVA1[0]\n",
    "\n",
    "MVA1_spline = interpolate.splrep(x=x_MVA1_values, y=MVA1_bins)\n",
    "MVA1_spline_values = interpolate.splev(x_MVA1_values, MVA1_spline)\n",
    "\n",
    "plt.plot(x_MVA1_values, MVA1_spline_values, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(3,10)\n",
    "plt.yscale('log')\n",
    "plt.xlabel(\"-log(1-MVA1)\")\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA1$>$0.95\")\n",
    "\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "worthy-injury",
   "metadata": {},
   "outputs": [],
   "source": [
    "s_bin = 3\n",
    "f_bin = 10\n",
    "nb_bins = 50\n",
    "label_hist = r'$Z \\rightarrow b\\bar{b}$'\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "MVA2 = plt.hist(-np.log(1-bb_df_2['EVT_MVA2']), bins=nb_bins, range=(s_bin, f_bin), density=True, histtype='step', label=label_hist, color= '#3182bd')\n",
    "x_MVA2_values = MVA2[1][:-1]\n",
    "MVA2_bins = MVA2[0]\n",
    "\n",
    "MVA2_spline = interpolate.splrep(x=x_MVA2_values, y=MVA2_bins)\n",
    "MVA2_spline_values = interpolate.splev(x_MVA2_values, MVA2_spline)\n",
    "\n",
    "plt.plot(x_MVA2_values, MVA2_spline_values, color='#de2d26', label=label_spline)\n",
    "\n",
    "\n",
    "plt.xlim(3,10)\n",
    "plt.yscale('log')\n",
    "plt.xlabel(\"-log(1-MVA2)\")\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA2$>$0.95\")\n",
    "plt.legend()\n",
    "\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "sustained-relation",
   "metadata": {},
   "source": [
    "## Histogrammes des valeurs en MVA + spline function + enregistrement de la spline function"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "minimal-woman",
   "metadata": {},
   "outputs": [],
   "source": [
    "#MVA1\n",
    "cut_var = 'EVT_MVA1' #:)\n",
    "cut_min = 3\n",
    "cut_max = 9\n",
    "nb_bins = 50\n",
    "\n",
    "label_hist = r'$Z \\rightarrow b\\bar{b}$'\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "counts, bin_edges = np.histogram(-np.log(1-bb_df_1[cut_var]), bins=nb_bins, range=(cut_min, cut_max))\n",
    "\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2\n",
    "err = np.sqrt(counts) #erreur en racine(N)\n",
    "#print(counts)\n",
    "\n",
    "#Normalise\n",
    "#err = err / np.sum(counts)\n",
    "#counts = counts / np.sum(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', color='k', markersize=2, label=label_hist) \n",
    "\n",
    "#Cubic spline of the MVA distribution\n",
    "weights = 1./err\n",
    "spline = interpolate.splrep(bin_centres, counts, w=weights)\n",
    "\n",
    "cut_vals = np.linspace(cut_min, cut_max, 1000) #pour avoir une courbe continue\n",
    "spline_vals = interpolate.splev(cut_vals, spline)\n",
    "\n",
    "plt.plot(cut_vals, spline_vals, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(cut_min, cut_max)\n",
    "plt.yscale('log')\n",
    "plt.xlabel(\"-log(1-MVA1)\") #:)\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA1$>$0.95\") #:)\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "comic-dealer",
   "metadata": {},
   "outputs": [],
   "source": [
    "#MVA2\n",
    "cut_var = 'EVT_MVA2'\n",
    "cut_min = 3\n",
    "cut_max = 8\n",
    "nb_bins = 35\n",
    "\n",
    "label_hist = r'$Z \\rightarrow b\\bar{b}$'\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "counts, bin_edges = np.histogram(-np.log(1-bb_df_2[cut_var]), bins=nb_bins, range=(cut_min, cut_max))\n",
    "\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2\n",
    "err = np.sqrt(counts) #erreur en racine(N)\n",
    "#print(counts)\n",
    "\n",
    "#Normalise\n",
    "#err = err / np.sum(counts)\n",
    "#counts = counts / np.sum(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', color='k', markersize=2, label=label_hist) \n",
    "\n",
    "#Cubic spline of the MVA distribution\n",
    "weights = 1./err\n",
    "spline = interpolate.splrep(bin_centres, counts, w=weights) \n",
    "\n",
    "cut_vals = np.linspace(cut_min, cut_max, 1000) #pour avoir une courbe continue\n",
    "spline_vals = interpolate.splev(cut_vals, spline)\n",
    "\n",
    "plt.plot(cut_vals, spline_vals, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(cut_min,cut_max)\n",
    "plt.yscale('log')\n",
    "plt.xlabel(\"-log(1-MVA2)\")\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA2$>$0.95\")\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "addressed-mattress",
   "metadata": {},
   "source": [
    "### Définition des splines"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "physical-springer",
   "metadata": {},
   "source": [
    "##### Définition de splines en log"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "numeric-notion",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[4695 4367 4042 3638 3395 3154 2772 2569 2369 2128 1954 1774 1660 1403\n",
      " 1332 1095 1017  885  789  741  623  511  493  469  353  344  249  286\n",
      "  231  217  169  140  142  115  104   97   67   63   60   42   36   33\n",
      "   29   31   29   21   23   16   17   17]\n",
      "[0.01459426 0.01513242 0.01572903 0.01657939 0.01716248 0.01780611\n",
      " 0.01899343 0.01972958 0.02054554 0.02167775 0.02262235 0.02374232\n",
      " 0.02454403 0.02669753 0.02739983 0.03021989 0.03135736 0.03361463\n",
      " 0.03560094 0.03673592 0.04006415 0.0442374  0.04503773 0.04617571\n",
      " 0.05322463 0.05391639 0.06337243 0.05913124 0.06579517 0.06788442\n",
      " 0.07692308 0.08451543 0.08391814 0.09325048 0.09805807 0.10153462\n",
      " 0.12216944 0.12598816 0.12909944 0.15430335 0.16666667 0.17407766\n",
      " 0.18569534 0.1796053  0.18569534 0.21821789 0.20851441 0.25\n",
      " 0.24253563 0.24253563]\n",
      "4896.050511783592\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Modélisation du nb d'élèments de bkg pour différentes valeurs de MVA1\n",
    "\n",
    "\n",
    "#Paramètres\n",
    "cut_var = 'EVT_MVA1' #:)\n",
    "\n",
    "cut_min = -np.log(1-0.95) #log\n",
    "cut_max = 9\n",
    "\n",
    "nb_bins = 50\n",
    "cut_vals = -np.log(1-bb_df_1[cut_var]) #:) #log\n",
    "\n",
    "\n",
    "\n",
    "#Programme\n",
    "label_hist = r'$Z \\rightarrow b\\bar{b}$'\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "counts, bin_edges = np.histogram(cut_vals, bins=nb_bins, range=(cut_min, cut_max))\n",
    "print(counts)\n",
    "\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2\n",
    "err = np.sqrt(counts) #erreur en racine(N)\n",
    "#print(err)\n",
    "\n",
    "#Normalise\n",
    "#err = err / np.sum(counts)\n",
    "#counts = counts / np.sum(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', color='k', markersize=2, label=label_hist) \n",
    "\n",
    "#Cubic spline of the MVA distribution\n",
    "weights = 1./err\n",
    "print(weights)\n",
    "spline = interpolate.splrep(bin_centres, counts, w=weights)\n",
    "\n",
    "cut_vals = np.linspace(cut_min, cut_max, 1000) #pour avoir une courbe continue\n",
    "spline_vals = interpolate.splev(cut_vals, spline)\n",
    "print(spline_vals.max())\n",
    "\n",
    "plt.plot(cut_vals, spline_vals, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(cut_min, cut_max)\n",
    "plt.xlabel(\"-log(1-MVA1)\") #:)\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA1$>$0.95\") #:)\n",
    "#plt.ylim(0,counts.max())\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n",
    "#pickle.dump(spline, open('MVA1_spline_log.pkl','wb')) #:)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "outstanding-filing",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[2.9957323 3.1387115 3.2816904 3.4246695 3.5676486 3.7106276 3.8536067\n",
      " 3.9965858 4.139565  4.282544  4.4255233 4.568502  4.711481  4.8544602\n",
      " 4.9974394 5.1404185 5.2833977 5.426377  5.5693555 5.7123346 5.855314\n",
      " 5.998293  6.141272  6.284251  6.4272304 6.570209  6.713188  6.8561673\n",
      " 6.9991465 7.1421256 7.2851048 7.428084  7.5710626 7.7140417 7.857021\n",
      " 8.       ]\n",
      "[3133 2761 2306 1955 1747 1400 1141 1014  805  683  523  475  372  284\n",
      "  227  185  141   92   72   63   57   38   39   16   15   12    8    6\n",
      "    5    2    3    2    2    1    1]\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Modélisation du nb d'élèments de bkg pour différentes valeurs de MVA1\n",
    "cut_var = 'EVT_MVA2' #:)\n",
    "cut_min = -np.log(1-0.95) #log\n",
    "cut_max = 8 #cut_vals.max()\n",
    "nb_bins = 35\n",
    "\n",
    "cut_vals = -np.log(1-bb_df_2[cut_var]) #:) #log\n",
    "\n",
    "\n",
    "label_hist = r'$Z \\rightarrow b\\bar{b}$'\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "counts, bin_edges = np.histogram(cut_vals, bins=nb_bins, range=(cut_min, cut_max))\n",
    "print(bin_edges)\n",
    "print(counts)\n",
    "\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2\n",
    "err = np.sqrt(counts) #erreur en racine(N)\n",
    "\n",
    "#Normalise\n",
    "#err = err / np.sum(counts)\n",
    "#counts = counts / np.sum(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', color='k', markersize=2, label=label_hist) \n",
    "\n",
    "#Cubic spline of the MVA distribution\n",
    "weights = 1./err\n",
    "spline = interpolate.splrep(bin_centres, counts, w=weights)\n",
    "\n",
    "cut_vals = np.linspace(cut_min, cut_max, 1000) #pour avoir une courbe continue\n",
    "spline_vals = interpolate.splev(cut_vals, spline)\n",
    "\n",
    "plt.plot(cut_vals, spline_vals, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(cut_min, cut_max)\n",
    "plt.xlabel(\"-log(1-MVA2)\") #:)\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA2$>$0.95\") #:)\n",
    "plt.ylim(0,counts.max())\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n",
    "#pickle.dump(spline, open('MVA2_spline_log.pkl','wb')) #:)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "interesting-conversation",
   "metadata": {},
   "outputs": [],
   "source": [
    "print(spline_vals.min())"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "sophisticated-coalition",
   "metadata": {},
   "source": [
    "##### Définitions de splines sans log"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "measured-desire",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "virtual-philadelphia",
   "metadata": {},
   "outputs": [],
   "source": [
    "#MVA1\n",
    "cut_var = 'EVT_MVA1' #:)\n",
    "cut_vals = bb_df_1[cut_var] #:) #log\n",
    "cut_min = 0.95 #log\n",
    "cut_max = cut_vals.max()\n",
    "nb_bins = 50\n",
    "print(cut_min)\n",
    "print(cut_max)\n",
    "\n",
    "label_hist = r'$Z \\rightarrow b\\bar{b}$'\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "counts, bin_edges = np.histogram(cut_vals, bins=nb_bins, range=(cut_min, cut_max))\n",
    "print(counts)\n",
    "\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2\n",
    "err = np.sqrt(counts) #erreur en racine(N)\n",
    "\n",
    "#Normalise\n",
    "#err = err / np.sum(counts)\n",
    "#counts = counts / np.sum(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', color='k', markersize=2, label=label_hist) \n",
    "\n",
    "#Cubic spline of the MVA distribution\n",
    "weights = 1./err\n",
    "spline = interpolate.splrep(bin_centres, counts, w=weights)\n",
    "\n",
    "cut_vals = np.linspace(cut_min, cut_max, 1000) #pour avoir une courbe continue\n",
    "spline_vals = interpolate.splev(cut_vals, spline)\n",
    "\n",
    "plt.plot(cut_vals, spline_vals, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(cut_min, cut_max)\n",
    "plt.xlabel(\"-log(1-MVA1)\") #:)\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA1$>$0.95\") #:)\n",
    "plt.ylim(0,counts.max())\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n",
    "#pickle.dump(spline, open('MVA1_spline.pkl','wb')) #:)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "wound-nebraska",
   "metadata": {},
   "outputs": [],
   "source": [
    "#MVA2\n",
    "cut_var = 'EVT_MVA2' #:)\n",
    "cut_vals = bb_df_2[cut_var] #:)\n",
    "cut_min = 0.95\n",
    "cut_max = cut_vals.max()\n",
    "nb_bins = 50\n",
    "\n",
    "label_hist = r'$Z \\rightarrow b\\bar{b}$'\n",
    "label_spline = r\"Associated spline function\"\n",
    "\n",
    "counts, bin_edges = np.histogram(cut_vals, bins=nb_bins, range=(cut_min, cut_max))\n",
    "\n",
    "bin_centres = (bin_edges[:-1] + bin_edges[1:])/2.\n",
    "err = np.sqrt(counts) #erreur en racine(N)\n",
    "#print(counts)\n",
    "\n",
    "#Normalise\n",
    "#err = err / np.sum(counts)\n",
    "#counts = counts / np.sum(counts)\n",
    "plt.errorbar(bin_centres, counts, yerr=err, fmt='o', color='k', markersize=2, label=label_hist) \n",
    "\n",
    "#Cubic spline of the MVA distribution\n",
    "weights = 1./err\n",
    "spline = interpolate.splrep(bin_centres, counts, w=weights) \n",
    "\n",
    "cut_vals = np.linspace(cut_min, cut_max, 1000) #pour avoir une courbe continue\n",
    "spline_vals = interpolate.splev(cut_vals, spline)\n",
    "\n",
    "plt.plot(cut_vals, spline_vals, color='#de2d26', label=label_spline)\n",
    "\n",
    "plt.xlim(cut_min,cut_max)\n",
    "plt.xlabel(\"MVA2\")\n",
    "plt.ylabel(\"Number of events\")\n",
    "plt.title(r\"$Z \\rightarrow b\\bar{b}$ data with MVA2$>$0.95\")\n",
    "plt.legend()\n",
    "plt.show()\n",
    "\n",
    "#pickle.dump(spline, open('MVA2_spline_log.pkl','wb'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "industrial-conference",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
